DROP TABLE IF EXISTS users_roles;
DROP TABLE IF EXISTS roles;
DROP TABLE IF EXISTS users;

CREATE TABLE IF NOT EXISTS roles
(
    id        UUID PRIMARY KEY NOT NULL,
    role_name VARCHAR(100)
);

CREATE TABLE IF NOT EXISTS users
(
    id       BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY NOT NULL,
    username VARCHAR(100),
    email    VARCHAR(100) UNIQUE
);

CREATE TABLE IF NOT EXISTS users_roles
(
    user_id BIGINT,
    role_id UUID,
    CONSTRAINT users_roles_pk PRIMARY KEY (user_id, role_id),
    CONSTRAINT user_id_fk FOREIGN KEY (user_id) REFERENCES users ON DELETE CASCADE,
    CONSTRAINT role_id_fk FOREIGN KEY (role_id) REFERENCES roles ON DELETE CASCADE
);